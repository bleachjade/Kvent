<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <title>Event Detail</title>
    <link rel="stylesheet" type="text/css" href="{% static '/css/event-detail.css' %}">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="true">

</head>

<body>
    <nav class="nav-bar">
        <a href="{% url 'index' %}">Kvent</a>
    <ul>
        {% if user.is_authenticated %}
        <li><a href="{% url 'event-history' username=request.user.username %}" id="event-logo">Your events</a></li>
        <li><a href="{% url 'profile' %}" id="event-logo">Profile</a></li>
        {% else %}
        <li><a href="{% url 'login' %}" id="event-logo">Login</a></li>
        {% endif%}
    </ul>
    </nav>
    <div class="row">
        <hr class="line">
        <div class="event-image">
            {% if not event.get_photo.url == '/media/upload/images/no_img.png' %}
            <img src="{{ event.get_photo.url }}" alt="sad" width="300px" height="auto" />
            {% else %}
            <img src="https://storage.cloud.google.com/kvent_bucket/upload/no_img.png?authuser=1" width="300px" height="auto" />
            {% endif %}
        </div>
        <div class="event-detail-box">
            <h4 id="event-name"> {{ event.get_event_name }} </h4>
            <h3>{{ event.get_long_description }}</h3>
            <h3>Will be held at {{ event.get_location }} </h3>
            <h3>Date: {{event.arrange_time}}</h3>
            <h3>Capacity: {{ event.get_number_people}} </h3>

            <h3>Host: {{ event.user }}</h3>
        
            {% if user not in event.participants.all %}
                {% if event.user == request.user.username %}
                    <a class="delete-button" href="{% url 'delete-event' event.id%}"><button> Delete </button></a>
                {% elif event.user != request.user.username %}
                    {% if event.get_vacant %}
                    <h3> Status : Vacant </h3>
                    <h3> Available : {{ event.get_available_capacity }} </h3>
                    <a class="join-button" href="{% url 'join-event' event.id%}"><button> Join </button></a>
                    {% elif  not event.get_vacant%}
                        <h3> Status : Full </h3>
                    {% endif %}
                {% endif %}
            {% endif%}

            {% for user in event.participants.all %}
            {% if request.user.username == user.username %}
              <a class="leave-button" href="{% url 'leave-event' event.id%}"><button> Leave </button></a>
            {% endif%}
            {% endfor %}


            {% for user in event.participants.all %}
                <h3> Participants :  {{ user.username }} </h3>
            {% endfor %}
        </div>
    </div>

</body>


</html>